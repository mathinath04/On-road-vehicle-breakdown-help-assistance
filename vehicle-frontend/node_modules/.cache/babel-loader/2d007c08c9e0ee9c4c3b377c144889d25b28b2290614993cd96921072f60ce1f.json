{"ast":null,"code":"import React,{useEffect,useState}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProviderDashboard=()=>{const[pendingRequests,setPendingRequests]=useState([]);const[loading,setLoading]=useState(true);const providerId=localStorage.getItem('userId');useEffect(()=>{const fetchPendingRequests=async()=>{try{const response=await fetch('http://localhost:5000/api/requests');const data=await response.json();if(data.success){setPendingRequests(data.helpRequests);}else{alert('‚ùå Failed to fetch pending help requests.');}}catch(error){console.error('Error fetching pending requests:',error);alert('‚ö†Ô∏è Server error. Please try again later.');}finally{setLoading(false);}};fetchPendingRequests();},[]);const acceptRequest=async requestId=>{if(!providerId){alert('üîí Provider not logged in.');return;}try{const response=await fetch(`http://localhost:5000/api/accept-help/${requestId}`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({providerId})});const data=await response.json();if(data.success){alert('‚úÖ Request accepted!');setPendingRequests(prev=>prev.filter(req=>req.id!==requestId));}else{alert(data.message||'‚ùå Failed to accept request.');}}catch(error){console.error('Error accepting request:',error);alert('‚ö†Ô∏è Error processing request.');}};const updateStatus=async(requestId,status)=>{try{const response=await fetch(`http://localhost:5000/api/update-status/${requestId}`,{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({status})});const data=await response.json();if(data.success){alert('‚úÖ Status updated!');setPendingRequests(prev=>prev.map(req=>req.id===requestId?{...req,status}:req));}else{alert(data.message||'‚ùå Failed to update status.');}}catch(error){console.error('Error updating status:',error);alert('‚ö†Ô∏è Error updating status.');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"container mt-5\",style:{maxWidth:'700px'},children:[/*#__PURE__*/_jsx(\"h2\",{className:\"mb-4\",children:\"\\uD83D\\uDEE0 Pending Help Requests\"}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"\\u23F3 Loading...\"}):pendingRequests.length>0?/*#__PURE__*/_jsx(\"ul\",{className:\"list-group shadow\",children:pendingRequests.map(req=>{var _req$provider_id;return/*#__PURE__*/_jsxs(\"li\",{className:\"list-group-item mb-3 rounded\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\uD83C\\uDD94 Request ID:\"}),\" \",req.id,\" \",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"\\uD83D\\uDCCD Location:\"}),\" \",req.location||'Not specified',/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"\\uD83D\\uDEE0 Issue:\"}),\" \",req.issue||req.details,/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"\\uD83E\\uDDD1\\u200D\\uD83D\\uDD27 Provider:\"}),' ',req.provider_name?`${req.provider_name} (${req.provider_email})`:'Not assigned yet',/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"\\uD83D\\uDCCC Status:\"}),\" \",req.status||'Pending',/*#__PURE__*/_jsx(\"br\",{}),!req.provider_id&&/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success mt-2 me-2\",onClick:()=>acceptRequest(req.id),children:\"\\u2705 Accept Help\"}),((_req$provider_id=req.provider_id)===null||_req$provider_id===void 0?void 0:_req$provider_id.toString())===providerId&&/*#__PURE__*/_jsxs(\"select\",{className:\"form-select mt-2\",defaultValue:\"\",onChange:e=>updateStatus(req.id,e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",disabled:true,children:\"Update Status\"}),/*#__PURE__*/_jsx(\"option\",{value:\"In Progress\",children:\"\\uD83D\\uDFE1 In Progress\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Resolved\",children:\"\\u2705 Resolved\"})]})]},req.id);})}):/*#__PURE__*/_jsx(\"p\",{children:\"\\uD83C\\uDF89 No pending requests right now.\"})]});};export default ProviderDashboard;","map":{"version":3,"names":["React","useEffect","useState","jsx","_jsx","jsxs","_jsxs","ProviderDashboard","pendingRequests","setPendingRequests","loading","setLoading","providerId","localStorage","getItem","fetchPendingRequests","response","fetch","data","json","success","helpRequests","alert","error","console","acceptRequest","requestId","method","headers","body","JSON","stringify","prev","filter","req","id","message","updateStatus","status","map","className","style","maxWidth","children","length","_req$provider_id","location","issue","details","provider_name","provider_email","provider_id","onClick","toString","defaultValue","onChange","e","target","value","disabled"],"sources":["D:/vehicle-breakdown-assistance/vehicle-frontend/src/components/ProviderDashboard.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\n\r\nconst ProviderDashboard = () => {\r\n  const [pendingRequests, setPendingRequests] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const providerId = localStorage.getItem('userId');\r\n\r\n  useEffect(() => {\r\n    const fetchPendingRequests = async () => {\r\n      try {\r\n        const response = await fetch('http://localhost:5000/api/requests');\r\n        const data = await response.json();\r\n        if (data.success) {\r\n          setPendingRequests(data.helpRequests);\r\n        } else {\r\n          alert('‚ùå Failed to fetch pending help requests.');\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching pending requests:', error);\r\n        alert('‚ö†Ô∏è Server error. Please try again later.');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchPendingRequests();\r\n  }, []);\r\n\r\n  const acceptRequest = async (requestId) => {\r\n    if (!providerId) {\r\n      alert('üîí Provider not logged in.');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`http://localhost:5000/api/accept-help/${requestId}`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ providerId }),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (data.success) {\r\n        alert('‚úÖ Request accepted!');\r\n        setPendingRequests((prev) => prev.filter((req) => req.id !== requestId));\r\n      } else {\r\n        alert(data.message || '‚ùå Failed to accept request.');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error accepting request:', error);\r\n      alert('‚ö†Ô∏è Error processing request.');\r\n    }\r\n  };\r\n\r\n  const updateStatus = async (requestId, status) => {\r\n    try {\r\n      const response = await fetch(`http://localhost:5000/api/update-status/${requestId}`, {\r\n        method: 'PUT',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ status }),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (data.success) {\r\n        alert('‚úÖ Status updated!');\r\n        setPendingRequests((prev) =>\r\n          prev.map((req) =>\r\n            req.id === requestId ? { ...req, status } : req\r\n          )\r\n        );\r\n      } else {\r\n        alert(data.message || '‚ùå Failed to update status.');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error updating status:', error);\r\n      alert('‚ö†Ô∏è Error updating status.');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"container mt-5\" style={{ maxWidth: '700px' }}>\r\n      <h2 className=\"mb-4\">üõ† Pending Help Requests</h2>\r\n      {loading ? (\r\n        <p>‚è≥ Loading...</p>\r\n      ) : pendingRequests.length > 0 ? (\r\n        <ul className=\"list-group shadow\">\r\n          {pendingRequests.map((req) => (\r\n            <li key={req.id} className=\"list-group-item mb-3 rounded\">\r\n              <strong>üÜî Request ID:</strong> {req.id} <br />\r\n              <strong>üìç Location:</strong> {req.location || 'Not specified'}<br />\r\n              <strong>üõ† Issue:</strong> {req.issue || req.details}<br />\r\n              <strong>üßë‚Äçüîß Provider:</strong>{' '}\r\n              {req.provider_name ? `${req.provider_name} (${req.provider_email})` : 'Not assigned yet'}<br />\r\n              <strong>üìå Status:</strong> {req.status || 'Pending'}<br />\r\n              {!req.provider_id && (\r\n                <button\r\n                  className=\"btn btn-success mt-2 me-2\"\r\n                  onClick={() => acceptRequest(req.id)}\r\n                >\r\n                  ‚úÖ Accept Help\r\n                </button>\r\n              )}\r\n\r\n              {req.provider_id?.toString() === providerId && (\r\n                <select\r\n                  className=\"form-select mt-2\"\r\n                  defaultValue=\"\"\r\n                  onChange={(e) => updateStatus(req.id, e.target.value)}\r\n                >\r\n                  <option value=\"\" disabled>\r\n                    Update Status\r\n                  </option>\r\n                  <option value=\"In Progress\">üü° In Progress</option>\r\n                  <option value=\"Resolved\">‚úÖ Resolved</option>\r\n                </select>\r\n              )}\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      ) : (\r\n        <p>üéâ No pending requests right now.</p>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProviderDashboard;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEnD,KAAM,CAAAC,iBAAiB,CAAGA,CAAA,GAAM,CAC9B,KAAM,CAACC,eAAe,CAAEC,kBAAkB,CAAC,CAAGP,QAAQ,CAAC,EAAE,CAAC,CAC1D,KAAM,CAACQ,OAAO,CAAEC,UAAU,CAAC,CAAGT,QAAQ,CAAC,IAAI,CAAC,CAE5C,KAAM,CAAAU,UAAU,CAAGC,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC,CAEjDb,SAAS,CAAC,IAAM,CACd,KAAM,CAAAc,oBAAoB,CAAG,KAAAA,CAAA,GAAY,CACvC,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,oCAAoC,CAAC,CAClE,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAF,QAAQ,CAACG,IAAI,CAAC,CAAC,CAClC,GAAID,IAAI,CAACE,OAAO,CAAE,CAChBX,kBAAkB,CAACS,IAAI,CAACG,YAAY,CAAC,CACvC,CAAC,IAAM,CACLC,KAAK,CAAC,0CAA0C,CAAC,CACnD,CACF,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,kCAAkC,CAAEA,KAAK,CAAC,CACxDD,KAAK,CAAC,0CAA0C,CAAC,CACnD,CAAC,OAAS,CACRX,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAEDI,oBAAoB,CAAC,CAAC,CACxB,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAU,aAAa,CAAG,KAAO,CAAAC,SAAS,EAAK,CACzC,GAAI,CAACd,UAAU,CAAE,CACfU,KAAK,CAAC,4BAA4B,CAAC,CACnC,OACF,CAEA,GAAI,CACF,KAAM,CAAAN,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,yCAAyCS,SAAS,EAAE,CAAE,CACjFC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAEnB,UAAW,CAAC,CACrC,CAAC,CAAC,CAEF,KAAM,CAAAM,IAAI,CAAG,KAAM,CAAAF,QAAQ,CAACG,IAAI,CAAC,CAAC,CAElC,GAAID,IAAI,CAACE,OAAO,CAAE,CAChBE,KAAK,CAAC,qBAAqB,CAAC,CAC5Bb,kBAAkB,CAAEuB,IAAI,EAAKA,IAAI,CAACC,MAAM,CAAEC,GAAG,EAAKA,GAAG,CAACC,EAAE,GAAKT,SAAS,CAAC,CAAC,CAC1E,CAAC,IAAM,CACLJ,KAAK,CAACJ,IAAI,CAACkB,OAAO,EAAI,6BAA6B,CAAC,CACtD,CACF,CAAE,MAAOb,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,0BAA0B,CAAEA,KAAK,CAAC,CAChDD,KAAK,CAAC,8BAA8B,CAAC,CACvC,CACF,CAAC,CAED,KAAM,CAAAe,YAAY,CAAG,KAAAA,CAAOX,SAAS,CAAEY,MAAM,GAAK,CAChD,GAAI,CACF,KAAM,CAAAtB,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,2CAA2CS,SAAS,EAAE,CAAE,CACnFC,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAEO,MAAO,CAAC,CACjC,CAAC,CAAC,CAEF,KAAM,CAAApB,IAAI,CAAG,KAAM,CAAAF,QAAQ,CAACG,IAAI,CAAC,CAAC,CAElC,GAAID,IAAI,CAACE,OAAO,CAAE,CAChBE,KAAK,CAAC,mBAAmB,CAAC,CAC1Bb,kBAAkB,CAAEuB,IAAI,EACtBA,IAAI,CAACO,GAAG,CAAEL,GAAG,EACXA,GAAG,CAACC,EAAE,GAAKT,SAAS,CAAG,CAAE,GAAGQ,GAAG,CAAEI,MAAO,CAAC,CAAGJ,GAC9C,CACF,CAAC,CACH,CAAC,IAAM,CACLZ,KAAK,CAACJ,IAAI,CAACkB,OAAO,EAAI,4BAA4B,CAAC,CACrD,CACF,CAAE,MAAOb,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,wBAAwB,CAAEA,KAAK,CAAC,CAC9CD,KAAK,CAAC,2BAA2B,CAAC,CACpC,CACF,CAAC,CAED,mBACEhB,KAAA,QAAKkC,SAAS,CAAC,gBAAgB,CAACC,KAAK,CAAE,CAAEC,QAAQ,CAAE,OAAQ,CAAE,CAAAC,QAAA,eAC3DvC,IAAA,OAAIoC,SAAS,CAAC,MAAM,CAAAG,QAAA,CAAC,oCAAwB,CAAI,CAAC,CACjDjC,OAAO,cACNN,IAAA,MAAAuC,QAAA,CAAG,mBAAY,CAAG,CAAC,CACjBnC,eAAe,CAACoC,MAAM,CAAG,CAAC,cAC5BxC,IAAA,OAAIoC,SAAS,CAAC,mBAAmB,CAAAG,QAAA,CAC9BnC,eAAe,CAAC+B,GAAG,CAAEL,GAAG,OAAAW,gBAAA,oBACvBvC,KAAA,OAAiBkC,SAAS,CAAC,8BAA8B,CAAAG,QAAA,eACvDvC,IAAA,WAAAuC,QAAA,CAAQ,0BAAc,CAAQ,CAAC,IAAC,CAACT,GAAG,CAACC,EAAE,CAAC,GAAC,cAAA/B,IAAA,QAAK,CAAC,cAC/CA,IAAA,WAAAuC,QAAA,CAAQ,wBAAY,CAAQ,CAAC,IAAC,CAACT,GAAG,CAACY,QAAQ,EAAI,eAAe,cAAC1C,IAAA,QAAK,CAAC,cACrEA,IAAA,WAAAuC,QAAA,CAAQ,qBAAS,CAAQ,CAAC,IAAC,CAACT,GAAG,CAACa,KAAK,EAAIb,GAAG,CAACc,OAAO,cAAC5C,IAAA,QAAK,CAAC,cAC3DA,IAAA,WAAAuC,QAAA,CAAQ,0CAAe,CAAQ,CAAC,CAAC,GAAG,CACnCT,GAAG,CAACe,aAAa,CAAG,GAAGf,GAAG,CAACe,aAAa,KAAKf,GAAG,CAACgB,cAAc,GAAG,CAAG,kBAAkB,cAAC9C,IAAA,QAAK,CAAC,cAC/FA,IAAA,WAAAuC,QAAA,CAAQ,sBAAU,CAAQ,CAAC,IAAC,CAACT,GAAG,CAACI,MAAM,EAAI,SAAS,cAAClC,IAAA,QAAK,CAAC,CAC1D,CAAC8B,GAAG,CAACiB,WAAW,eACf/C,IAAA,WACEoC,SAAS,CAAC,2BAA2B,CACrCY,OAAO,CAAEA,CAAA,GAAM3B,aAAa,CAACS,GAAG,CAACC,EAAE,CAAE,CAAAQ,QAAA,CACtC,oBAED,CAAQ,CACT,CAEA,EAAAE,gBAAA,CAAAX,GAAG,CAACiB,WAAW,UAAAN,gBAAA,iBAAfA,gBAAA,CAAiBQ,QAAQ,CAAC,CAAC,IAAKzC,UAAU,eACzCN,KAAA,WACEkC,SAAS,CAAC,kBAAkB,CAC5Bc,YAAY,CAAC,EAAE,CACfC,QAAQ,CAAGC,CAAC,EAAKnB,YAAY,CAACH,GAAG,CAACC,EAAE,CAAEqB,CAAC,CAACC,MAAM,CAACC,KAAK,CAAE,CAAAf,QAAA,eAEtDvC,IAAA,WAAQsD,KAAK,CAAC,EAAE,CAACC,QAAQ,MAAAhB,QAAA,CAAC,eAE1B,CAAQ,CAAC,cACTvC,IAAA,WAAQsD,KAAK,CAAC,aAAa,CAAAf,QAAA,CAAC,0BAAc,CAAQ,CAAC,cACnDvC,IAAA,WAAQsD,KAAK,CAAC,UAAU,CAAAf,QAAA,CAAC,iBAAU,CAAQ,CAAC,EACtC,CACT,GA5BMT,GAAG,CAACC,EA6BT,CAAC,EACN,CAAC,CACA,CAAC,cAEL/B,IAAA,MAAAuC,QAAA,CAAG,6CAAiC,CAAG,CACxC,EACE,CAAC,CAEV,CAAC,CAED,cAAe,CAAApC,iBAAiB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}